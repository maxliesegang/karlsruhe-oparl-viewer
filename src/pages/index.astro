---
import Layout from "../layouts/Layout.astro";
import Search from "astro-pagefind/components/Search";

const pagefindEnabled = !["1", "true", "yes"].includes(
  (import.meta.env.SKIP_PAGEFIND ?? "").toLowerCase(),
);

const uiOptions = {
  showImages: false,
  pageSize: 10,
  sort: {
    date: "dsc",
  },
  translations: {
    placeholder: "Suchen",
    clear_search: "Löschen",
    load_more: "Mehr Ergebnisse laden",
    search_label: "Diese Seite durchsuchen",
    filters_label: "Filter",
    zero_results: "Keine Ergebnisse für [SEARCH_TERM]",
    many_results: "[COUNT] Ergebnisse für [SEARCH_TERM]",
    one_result: "[COUNT] Ergebnis für [SEARCH_TERM]",
    alt_search:
      "Keine Ergebnisse für [SEARCH_TERM]. Stattdessen werden Ergebnisse für [DIFFERENT_TERM] angezeigt",
    search_suggestion:
      "Keine Ergebnisse für [SEARCH_TERM]. Versuchen Sie eine der folgenden Suchen:",
    searching: "Suche nach [SEARCH_TERM]...",
  },
};
---

<Layout>
  <div class="container">
    <h1 class="page-header">GemeinderatsRadar</h1>
    {
      pagefindEnabled ? (
        <Search id="search" className="pagefind-ui" uiOptions={uiOptions} />
      ) : (
        <p class="search-disabled" role="status">
          Suche ist in diesem schnellen Build deaktiviert (SKIP_PAGEFIND=1).
        </p>
      )
    }
  </div>
</Layout>

<style>
  .search-disabled {
    margin: 16px auto 0;
    max-width: 760px;
    padding: 10px 12px;
    border: 1px dashed var(--color-border);
    border-radius: var(--radius);
    color: var(--color-text-muted);
    text-align: center;
    font-size: 0.92rem;
  }
</style>
